<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="chatbot_page" name="Dragon Coders AI Chatbot">
        <t t-call="web.layout">
            <t t-set="head">
                <title>Dragon Coders AI Chatbot</title>

                <!-- Bootstrap 5 CSS -->
                <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
                    rel="stylesheet" />
                <link
                    href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css"
                    rel="stylesheet" />

                <!-- Custom CSS -->
                <link rel="stylesheet" href="/customer_support/static/src/css/portal_dashboard.css" />
                <link rel="stylesheet" href="/customer_support/static/src/css/chatbot.css" />

                <style>

                </style>
            </t>

            <div class="dashboard-wrapper">
                <!-- Top Navigation Header -->
                <header class="dashboard-header">
                    <div class="header-content">
                        <div class="header-nav">
                            <a href="/customer_support/dashboard" class="nav-link">
                                <i class="bi bi-speedometer2 me-2"></i>Overview </a>
                            <a href="/customer_support/tickets" class="nav-link">
                                <i class="bi bi-ticket-detailed me-2"></i>Tickets </a>
                            <a href="#" class="nav-link">
                                <i class="bi bi-graph-up me-2"></i>Reporting </a>
                            <a href="/customer_support/chatbot" class="nav-link active">
                                <i class="bi bi-chat-dots me-2"></i>FAQ </a>
                        </div>
                        <div class="header-right">
                            <div class="header-actions">
                                <a href="/customer_support/create_ticket" class="btn-new-ticket">
                                    <i class="bi bi-plus-circle me-2"></i>New Ticket </a>
                            </div>

                            <!-- User Profile -->
                            <div class="user-profile dropdown">
                                <i class="bi bi-grid-3x3-gap-fill text-white me-3"
                                    style="font-size: 1.2rem; cursor: pointer;"></i>
                                <i class="bi bi-bell-fill text-white me-3"
                                    style="font-size: 1.2rem; cursor: pointer;"></i>

                                <!-- Clickable Profile - FIXED: Using request.env.user -->
                                <a class="d-flex align-items-center text-white dropdown-toggle"
                                    href="#"
                                    id="userProfileDropdown"
                                    data-bs-toggle="dropdown"
                                    aria-expanded="false"
                                    style="text-decoration: none;">

                                    <span class="user-name me-3">
                                        <t t-esc="request.env.user.name" />
                                    </span>

                                    <img
                                        t-att-src="'/web/image/res.users/%s/avatar_128' % request.env.user.id"
                                        alt="User Avatar"
                                        class="user-avatar"
                                        onerror="this.src='/web/static/img/avatar_gray.svg'" />
                                </a>

                                <ul class="dropdown-menu dropdown-menu-end"
                                    aria-labelledby="userProfileDropdown">
                                    <li>
                                        <a class="dropdown-item" href="/customer_support/profile">
                                            <i class="bi bi-person me-2"></i> Edit Profile </a>
                                    </li>
                                    <li>
                                        <hr class="dropdown-divider" />
                                    </li>
                                    <li>
                                        <a class="dropdown-item text-danger"
                                            href="/customer_support/logout_manual">
                                            <i class="bi bi-box-arrow-right me-2"></i> Logout </a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </header>

                <!-- Chatbot Content -->
                <div class="dashboard-content">
                    <div class="chat-container">

                        <div id="chat-box" class="chat-box"></div>

                        <div class="quick-replies">
                            <button class="quick-reply" data-msg="Services">Services</button>
                            <button class="quick-reply" data-msg="Pricing">Pricing</button>
                            <button class="quick-reply" data-msg="Request Demo">Request Demo</button>
                            <button class="quick-reply" data-msg="Contact Support">Contact Support</button>
                        </div>

                        <div class="input-area">
                            <input id="user-input" type="text" placeholder="Type your message..." />
                            <button id="send-msg-btn">Send</button>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Bootstrap JS -->
            <script
                src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

            <!-- Chatbot JavaScript -->
            <script type="text/javascript" src="/customer_support/static/src/js/chatbot.js"></script>
        </t>
    </template>
</odoo>